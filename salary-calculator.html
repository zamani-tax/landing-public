<!DOCTYPE html><html lang="fa" dir="rtl"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="sitemap" href="/sitemap-index.xml"><meta name="generator" content="Astro v5.13.5"><title>ماشین‌حساب حقوق و دستمزد ۱۴۰۴ | مشاوره مالیاتی زمانی</title><!-- ✅ سئو --><meta name="description" content="محاسبه‌ی پایه، مزایا، بیمه، مالیات، خالص پرداختی و هزینهٔ کارفرما – ۱۰۰٪ استاتیک"><link rel="canonical" href="https://zamani.tax/salary-calculator.html"><!-- Open Graph --><meta property="og:type" content="website"><meta property="og:site_name" content="zamani.tax"><meta property="og:title" content="ماشین‌حساب حقوق و دستمزد ۱۴۰۴ | مشاوره مالیاتی زمانی"><meta property="og:description" content="محاسبه‌ی پایه، مزایا، بیمه، مالیات، خالص پرداختی و هزینهٔ کارفرما – ۱۰۰٪ استاتیک"><meta property="og:url" content="https://zamani.tax/salary-calculator.html"><meta property="og:image" content="https://zamani.tax/favicon.svg"><meta property="og:locale" content="fa_IR"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="ماشین‌حساب حقوق و دستمزد ۱۴۰۴ | مشاوره مالیاتی زمانی"><meta name="twitter:description" content="محاسبه‌ی پایه، مزایا، بیمه، مالیات، خالص پرداختی و هزینهٔ کارفرما – ۱۰۰٪ استاتیک"><meta name="twitter:image" content="https://zamani.tax/favicon.svg"><!-- JSON-LD --><script type="application/ld+json">{"@context":"https://schema.org","@type":"Person","name":"محسن زماني","jobTitle":"مشاور و مدرس مالياتي","url":"https://zamani.tax","sameAs":["https://instagram.com/mohsen.zamani.tax","https://www.youtube.com/@zamani_tax","https://t.me/zamanitax","https://www.linkedin.com/in/zamanitax"]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"zamani.tax","url":"https://zamani.tax","inLanguage":"fa-IR","potentialAction":{"@type":"SearchAction","target":"https://zamani.tax/search?q={query}","query-input":"required name=query"}}</script><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.DuVyq0gm.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><link rel="stylesheet" href="/_astro/about.0RVsEVSs.css"><script type="module" src="/_astro/page.BNYwb576.js"></script></head> <body class="bg-grayLight font-peyda">  <section class="container mx-auto px-6 py-12" dir="rtl"> <header class="mb-8 text-center"> <h1 class="text-3xl font-bold mb-2">ماشین‌حساب حقوق و دستمزد ۱۴۰۴</h1> <p class="text-gray-600">محاسبه‌ی پایه، مزایا، بیمه، مالیات، خالص پرداختی و هزینهٔ کارفرما – ۱۰۰٪ استاتیک</p> </header> <div class="grid grid-cols-1 lg:grid-cols-3 gap-6"> <!-- فرم ورودی --> <div class="lg:col-span-1 bg-white rounded-2xl shadow p-4"> <div class="flex items-center justify-between mb-4"> <h2 class="text-xl font-semibold">ورودی‌ها</h2> <span id="cfg-source" class="text-xs text-gray-500"></span> </div> <div id="form-root" class="space-y-4"></div> </div> <!-- خروجی‌ها --> <div class="lg:col-span-2 space-y-6"> <div class="bg-white rounded-2xl shadow p-4"> <h3 class="text-lg font-semibold mb-4">خروجی‌های کلیدی</h3> <div id="outputs" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div> </div> <div class="bg-white rounded-2xl shadow p-4"> <h3 class="text-lg font-semibold mb-4">
تنظیمات قانون (اختیاری)
</h3> <p class="text-sm text-gray-600 mb-4">
می‌توانی معافیت و طبقات مالیاتی و همچنین ارقام مزایا را
                        همین‌جا اصلاح کنی.
</p> <div id="law-root" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div> </div> <div class="flex gap-3"> <button id="btn-preset" class="px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200">پر کردن حداقل‌های نمونه</button> <button id="btn-pdf" class="px-4 py-2 rounded-xl bg-gray-900 text-white hover:bg-black">دانلود PDF</button> </div> </div> </div> </section>  <script type="module" src="/_astro/salary-calculator.astro_astro_type_script_index_0_lang.w1TaPnre.js"></script> <script type="module">
        // ایمپورت مطمئن (بدون alias)
        import { computePayroll } from "/src/lib/payroll.ts";

        const Rial = (n) =>
            new Intl.NumberFormat("fa-IR").format(Number(n || 0));
        const $ = (sel) => document.querySelector(sel);

        const state = {
            cfg: null,
            input: {
                mode: "daily",
                baseWage: 0,
                days: 30,
                hoursOvertime: 0,
                overtimeFactor: 1.4,
                married: false,
                childCount: 0,
                includeHousing: true,
                includeFood: true,
                includeChildAllowance: true,
                includeInsurance: true,
                includeTax: true,
                includeSeverance: false,
                severanceMonthly: 0,
            },
        };

        // کانفیگ پیش‌فرض (اگر JSON لود نشد)
        const FALLBACK_CFG = {
            year: 1404,
            workHoursMonthly: 220,
            insurance: { worker: 0.07, employer: 0.2, unemployment: 0.03 },
            allowances: {
                housing: 9000000,
                food: 22000000,
                childPerKid: 5000000,
            },
            tax: {
                exemptionMonthly: 0,
                brackets: [
                    { upTo: 0, rate: 0.0 },
                    { upTo: 0, rate: 0.0 },
                    { upTo: null, rate: 0.0 },
                ],
            },
        };

        // رندر فرم‌ها
        function inputNumber(label, key, min = 0) {
            return `<label class="block">
        <span class="text-sm text-gray-700">${label}</span>
        <input type="number" inputmode="numeric" min="${min}" value="${state.input[key]}"
          data-key="${key}"
          class="mt-1 w-full rounded-xl border-gray-300 focus:ring-0 focus:border-gray-400 px-3 py-2" />
      </label>`;
        }
        function inputSwitch(label, key) {
            return `<label class="flex items-center justify-between gap-3">
        <span class="text-sm text-gray-700">${label}</span>
        <input type="checkbox" ${state.input[key] ? "checked" : ""} data-key="${key}" class="h-5 w-5" />
      </label>`;
        }
        function selectMode() {
            return `<label class="block">
        <span class="text-sm text-gray-700">نوع مزد پایه</span>
        <select data-key="mode" class="mt-1 w-full rounded-xl border-gray-300 focus:ring-0 focus:border-gray-400 px-3 py-2">
          <option value="daily" ${state.input.mode === "daily" ? "selected" : ""}>روزانه</option>
          <option value="monthly" ${state.input.mode === "monthly" ? "selected" : ""}>ماهانه</option>
          <option value="hourly" ${state.input.mode === "hourly" ? "selected" : ""}>ساعتی</option>
        </select>
      </label>`;
        }

        function renderForm() {
            const root = $("#form-root");
            root.innerHTML = `
        ${selectMode()}
        ${inputNumber("مزد پایه (بر حسب نوع فوق)", "baseWage")}
        ${inputNumber("روزهای کارکرد ماه", "days")}
        ${inputNumber("ساعات اضافه‌کاری", "hoursOvertime")}
        ${inputNumber("ضریب اضافه‌کاری", "overtimeFactor", 1)}
        <div class="grid grid-cols-2 gap-4">
          ${inputSwitch("متأهل", "married")}
          ${inputNumber("تعداد فرزند", "childCount")}
        </div>
        <hr class="my-2"/>
        ${inputSwitch("حق مسکن لحاظ شود", "includeHousing")}
        ${inputSwitch("بن کارگری لحاظ شود", "includeFood")}
        ${inputSwitch("حق اولاد لحاظ شود", "includeChildAllowance")}
        ${inputSwitch("محاسبه بیمه", "includeInsurance")}
        ${inputSwitch("محاسبه مالیات", "includeTax")}
        ${inputSwitch("سنوات توافقی لحاظ شود", "includeSeverance")}
        ${inputNumber("مبلغ سنوات ماهانه (درصورت توافق)", "severanceMonthly")}
      `;
            root.querySelectorAll("[data-key]").forEach((el) => {
                el.addEventListener("input", (e) => {
                    const k = e.currentTarget.getAttribute("data-key");
                    if (el.type === "checkbox") state.input[k] = el.checked;
                    else if (el.tagName === "SELECT") state.input[k] = el.value;
                    else state.input[k] = Number(el.value || 0);
                    update();
                });
            });
        }

        function card(title, value, sub = null) {
            return `<div class="rounded-xl border p-3">
        <div class="text-sm text-gray-500 mb-1">${title}</div>
        <div class="text-xl font-bold">${Rial(value)} ریال</div>
        ${sub ? `<div class="text-xs text-gray-500 mt-1">${sub}</div>` : ""}
      </div>`;
        }

        function update() {
            if (!state.cfg) return;
            const res = computePayroll(state.cfg, state.input);
            $("#outputs").innerHTML = `
        ${card("مزد ساعتی", res.hourlyWage)}
        ${card("پایه حقوق ماهانه", res.baseMonthly)}
        ${card("حق مسکن", res.allowancesIncluded.housing)}
        ${card("بن کارگری", res.allowancesIncluded.food)}
        ${card("حق اولاد", res.allowancesIncluded.child, state.input.married ? `${state.input.childCount} فرزند` : "-")}
        ${card("اضافه‌کاری", res.overtime)}
        ${card("سنوات ماهانه", res.severanceMonthly)}
        ${card("جمع قبل از کسورات", res.grossBeforeDeductions)}
        ${card("مبلغ مشمول بیمه", res.insuranceBase)}
        ${card("بیمه کارگر", res.insurance.worker)}
        ${card("بیمه کارفرما", res.insurance.employer)}
        ${card("بیمه بیکاری", res.insurance.unemployment)}
        ${card("درآمد مشمول مالیات", res.taxableIncome)}
        ${card("مالیات حقوق", res.tax)}
        ${card("خالص پرداختی", res.netPay)}
        ${card("هزینه کل کارفرما", res.employerCost)}
      `;
        }

        function renderLawEditor() {
            const root = $("#law-root");
            const c = state.cfg;
            root.innerHTML = `
        <label class="block">
          <span class="text-sm text-gray-700">معافیت ماهانه مالیات</span>
          <input id="exempt" type="number" value="${c.tax.exemptionMonthly}" class="mt-1 w-full rounded-xl border-gray-300 px-3 py-2" />
        </label>
        <label class="block">
          <span class="text-sm text-gray-700">طبقه ۱ – سقف (ریال)</span>
          <div class="flex gap-2 mt-1">
            <input id="b1up" type="number" value="${c.tax.brackets[0].upTo ?? 0}" class="w-1/2 rounded-xl border-gray-300 px-3 py-2" />
            <input id="b1rt" type="number" step="0.01" value="${c.tax.brackets[0].rate}" class="w-1/2 rounded-xl border-gray-300 px-3 py-2" />
          </div>
        </label>
        <label class="block">
          <span class="text-sm text-gray-700">طبقه ۲ – سقف (ریال)</span>
          <div class="flex gap-2 mt-1">
            <input id="b2up" type="number" value="${c.tax.brackets[1].upTo ?? 0}" class="w-1/2 rounded-xl border-gray-300 px-3 py-2" />
            <input id="b2rt" type="number" step="0.01" value="${c.tax.brackets[1].rate}" class="w-1/2 rounded-xl border-gray-300 px-3 py-2" />
          </div>
        </label>
        <label class="block">
          <span class="text-sm text-gray-700">طبقه ۳ – مازاد با نرخ</span>
          <input id="b3rt" type="number" step="0.01" value="${c.tax.brackets[2].rate}" class="mt-1 w-full rounded-xl border-gray-300 px-3 py-2" />
        </label>
        <div class="grid grid-cols-3 gap-2">
          <label class="block">
            <span class="text-xs text-gray-700">حق مسکن</span>
            <input id="housing" type="number" value="${c.allowances.housing}" class="mt-1 w-full rounded-xl border-gray-300 px-3 py-2" />
          </label>
          <label class="block">
            <span class="text-xs text-gray-700">بن کارگری</span>
            <input id="food" type="number" value="${c.allowances.food}" class="mt-1 w-full rounded-xl border-gray-300 px-3 py-2" />
          </label>
          <label class="block">
            <span class="text-xs text-gray-700">حق اولاد/هر فرزند</span>
            <input id="child" type="number" value="${c.allowances.childPerKid}" class="mt-1 w-full rounded-xl border-gray-300 px-3 py-2" />
          </label>
        </div>
        <div class="grid grid-cols-3 gap-2">
          <label class="block">
            <span class="text-xs text-gray-700">بیمه کارگر</span>
            <input id="iw" type="number" step="0.01" value="${c.insurance.worker}" class="mt-1 w-full rounded-xl border-gray-300 px-3 py-2" />
          </label>
          <label class="block">
            <span class="text-xs text-gray-700">بیمه کارفرما</span>
            <input id="ie" type="number" step="0.01" value="${c.insurance.employer}" class="mt-1 w-full rounded-xl border-gray-300 px-3 py-2" />
          </label>
          <label class="block">
            <span class="text-xs text-gray-700">بیمه بیکاری</span>
            <input id="iu" type="number" step="0.01" value="${c.insurance.unemployment}" class="mt-1 w-full rounded-xl border-gray-300 px-3 py-2" />
          </label>
        </div>
      `;

            const bind = (id, fn) =>
                document.getElementById(id).addEventListener("input", fn);
            bind("exempt", (e) => {
                state.cfg.tax.exemptionMonthly = Number(e.target.value || 0);
                update();
            });
            bind("b1up", (e) => {
                state.cfg.tax.brackets[0].upTo = Number(e.target.value || 0);
                update();
            });
            bind("b1rt", (e) => {
                state.cfg.tax.brackets[0].rate = Number(e.target.value || 0);
                update();
            });
            bind("b2up", (e) => {
                state.cfg.tax.brackets[1].upTo = Number(e.target.value || 0);
                update();
            });
            bind("b2rt", (e) => {
                state.cfg.tax.brackets[1].rate = Number(e.target.value || 0);
                update();
            });
            bind("b3rt", (e) => {
                state.cfg.tax.brackets[2].rate = Number(e.target.value || 0);
                update();
            });
            bind("housing", (e) => {
                state.cfg.allowances.housing = Number(e.target.value || 0);
                update();
            });
            bind("food", (e) => {
                state.cfg.allowances.food = Number(e.target.value || 0);
                update();
            });
            bind("child", (e) => {
                state.cfg.allowances.childPerKid = Number(e.target.value || 0);
                update();
            });
            bind("iw", (e) => {
                state.cfg.insurance.worker = Number(e.target.value || 0);
                update();
            });
            bind("ie", (e) => {
                state.cfg.insurance.employer = Number(e.target.value || 0);
                update();
            });
            bind("iu", (e) => {
                state.cfg.insurance.unemployment = Number(e.target.value || 0);
                update();
            });
        }

        function bindButtons() {
            document.getElementById("btn-pdf").addEventListener("click", () => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({ unit: "pt", format: "a4" });
                const res = computePayroll(state.cfg, state.input);
                let y = 40;
                const add = (t, v) => {
                    doc.text(
                        `${t}: ${new Intl.NumberFormat("fa-IR").format(v)} ریال`,
                        40,
                        y,
                    );
                    y += 20;
                };
                doc.setFontSize(14);
                doc.text("فیش محاسبات حقوق و دستمزد (نمونه)", 40, y);
                y += 30;
                add("پایه حقوق ماهانه", res.baseMonthly);
                add("حق مسکن", res.allowancesIncluded.housing);
                add("بن کارگری", res.allowancesIncluded.food);
                add("حق اولاد", res.allowancesIncluded.child);
                add("اضافه‌کاری", res.overtime);
                add("جمع قبل از کسورات", res.grossBeforeDeductions);
                add("مبلغ مشمول بیمه", res.insuranceBase);
                add("بیمه کارگر", res.insurance.worker);
                add("بیمه کارفرما", res.insurance.employer);
                add("بیمه بیکاری", res.insurance.unemployment);
                add("درآمد مشمول مالیات", res.taxableIncome);
                add("مالیات حقوق", res.tax);
                add("خالص پرداختی", res.netPay);
                add("هزینه کل کارفرما", res.employerCost);
                doc.save("payroll-1404.pdf");
            });

            document
                .getElementById("btn-preset")
                .addEventListener("click", () => {
                    state.input.mode = "daily";
                    state.input.baseWage = 2000000;
                    state.input.days = 30;
                    state.input.hoursOvertime = 10;
                    state.input.overtimeFactor = 1.4;
                    state.input.married = true;
                    state.input.childCount = 1;
                    state.input.includeHousing = true;
                    state.input.includeFood = true;
                    state.input.includeChildAllowance = true;
                    state.input.includeInsurance = true;
                    state.input.includeTax = true;
                    state.input.includeSeverance = false;
                    state.input.severanceMonthly = 0;
                    renderForm();
                    update();
                });
        }

        // بارگذاری امن کانفیگ از چند مسیر + فالبک
        async function loadConfigSafe() {
            const base = (import.meta.env.BASE_URL || "/").replace(/\/+$/, "/");
            const candidates = [
                base + "payroll-1404.json", // اگر base ست باشد
                "/payroll-1404.json", // ریشه سایت
                "payroll-1404.json", // نسبی به صفحه
            ];

            for (const url of candidates) {
                try {
                    const res = await fetch(url, { cache: "no-store" });
                    if (res.ok) {
                        const json = await res.json();
                        $("#cfg-source").textContent = "منبع تنظیمات: " + url;
                        return json;
                    }
                } catch (e) {
                    // ادامه می‌دهیم تا کاندید بعدی امتحان شود
                }
            }
            $("#cfg-source").textContent = "منبع تنظیمات: پیش‌فرض داخلی";
            return FALLBACK_CFG;
        }

        window.addEventListener("DOMContentLoaded", async () => {
            try {
                state.cfg = await loadConfigSafe();
                renderForm();
                renderLawEditor();
                bindButtons();
                update();
            } catch (err) {
                console.error(err);
                document.querySelector("#form-root")?.insertAdjacentHTML(
                    "beforebegin",
                    `<div class="rounded-xl border border-red-200 bg-red-50 p-3 text-red-700">
            خطا در بارگذاری <code>payroll-1404.json</code>. فعلاً با تنظیمات پیش‌فرض ادامه دادیم.
          </div>`,
                );
                state.cfg = FALLBACK_CFG;
                renderForm();
                renderLawEditor();
                bindButtons();
                update();
            }
        });
    </script>  </body></html>