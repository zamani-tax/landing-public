import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.RH_Wq4ov.js";function n(c=""){return String(c).trim().replace(/\u200c/g,"").replace(/[ي]/g,"ی").replace(/[ك]/g,"ک").replace(/[۰-۹]/g,a=>String("۰۱۲۳۴۵۶۷۸۹".indexOf(a))).toLowerCase()}function f(c){const a={};for(const d of Object.keys(c||{})){const r=d.trim(),l=c[d];a[r]=typeof l=="string"?l.trim():l}return a}function j(c){const a=f(c),d=Object.entries(a).map(([e,s])=>[n(e),e,s]),r=e=>{const s=d.find(([m])=>e.every(y=>m.includes(y)));return s?s[1]:null},l=r(["id"])||r(["شناسه"]),h=r(["description","id"])||r(["شرح","خدمت"])||r(["شرح"]),i=r(["vat"])||r(["مالیات","ارزش"])||r(["درصد","vat"]),p=r(["type"])||r(["نوع"]),x=r(["specialorgeneral"])||r(["عمومی"])||r(["خاص"]),u=r(["run","date"])||r(["تاریخ","اجرا"]),g=r(["last","edit","date"])||r(["آخرین","ویرایش"]);return{id:l?a[l]:"",title:h?a[h]:"",vat:i?a[i]:"",type:p?a[p]:"",scope:x?a[x]:"",runDate:u?a[u]:"",lastEditDate:g?a[g]:"",__raw:a}}const N=()=>{const[c,a]=o.useState(""),[d,r]=o.useState([]),[l,h]=o.useState(""),[i,p]=o.useState(!1);o.useEffect(()=>{fetch("/search_service_id.json").then(e=>{if(!e.ok)throw new Error("خطا در دریافت search_service_id.json");return e.json()}).then(e=>{let s=[];Array.isArray(e)?s=e:Array.isArray(e?.data)?s=e.data:typeof e=="object"&&(s=Object.values(e)),r(s),h("")}).catch(e=>{console.error(e),h("خطا در بارگذاری داده‌ها. مسیر /search_service_id.json را بررسی کنید.")})},[]);const x=o.useMemo(()=>d.map(j),[d]),u=o.useMemo(()=>{const e=n(c);return e.length<=1?[]:x.filter(s=>!(![n(s.id),n(s.title),n(s.vat),n(s.type),n(s.scope),n(s.runDate),n(s.lastEditDate)].join(" ").includes(e)||i&&n(s.scope)!=="عمومی")).slice(0,20)},[x,c,i]),g=e=>a(e.target.value);return t.jsxs("div",{className:"w-full max-w-4xl mx-auto",children:[t.jsxs("div",{className:"relative mb-3",children:[t.jsx("input",{type:"text",placeholder:"جستجو در «شناسه»، «شرح خدمت»، «نوع»، «عمومی/خاص» یا «VAT»…",value:c,onChange:g,className:"w-full border rounded-lg p-3 shadow-sm focus:outline-none focus:ring-2 focus:ring-[#B50000] dark:bg-[#0f172a] dark:text-gray-100 dark:border-gray-700",dir:"rtl"}),l&&t.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:l})]}),t.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 mb-4",children:[t.jsx("input",{type:"checkbox",checked:i,onChange:e=>p(e.target.checked),className:"rounded border-gray-300 dark:border-gray-600"}),"فقط نمایش شناسه عمومی"]}),c.trim().length>1&&t.jsx(t.Fragment,{children:u.length>0?t.jsxs("table",{className:"w-full mt-2 border border-gray-300 rounded-lg text-sm overflow-hidden dark:border-gray-700",children:[t.jsx("thead",{className:"bg-gray-200 dark:bg-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-2 text-right",children:"شناسه"}),t.jsx("th",{className:"p-2 text-right",children:"شرح خدمت"}),t.jsx("th",{className:"p-2 text-right",children:"نوع"}),t.jsx("th",{className:"p-2 text-right",children:"عمومی/خاص"}),t.jsx("th",{className:"p-2 text-right",children:"VAT"}),t.jsx("th",{className:"p-2 text-right",children:"تاریخ اجرا"}),t.jsx("th",{className:"p-2 text-right",children:"آخرین ویرایش"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-slate-900",children:u.map((e,s)=>t.jsxs("tr",{className:"border-t hover:bg-gray-50 dark:hover:bg-slate-800 dark:border-gray-700",children:[t.jsx("td",{className:"p-2 ltr",children:e.id||"—"}),t.jsx("td",{className:"p-2",children:e.title||"—"}),t.jsx("td",{className:"p-2",children:e.type||"—"}),t.jsx("td",{className:"p-2",children:e.scope||"—"}),t.jsx("td",{className:"p-2",children:e.vat?`${e.vat}%`:"—"}),t.jsx("td",{className:"p-2",children:e.runDate||"—"}),t.jsx("td",{className:"p-2",children:e.lastEditDate||"—"})]},s))})]}):t.jsx("p",{className:"mt-4 text-sm text-gray-600 dark:text-gray-300",children:"هیچ موردی یافت نشد."})})]})};export{N as default};
