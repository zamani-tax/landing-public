import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.RH_Wq4ov.js";function l(c=""){return String(c).trim().replace(/\u200c/g,"").replace(/[ی]/g,"ی").replace(/[ك]/g,"ک").replace(/[۰-۹]/g,a=>String("۰۱۲۳۴۵۶۷۸۹".indexOf(a))).toLowerCase()}function f(c){const a={};for(const d of Object.keys(c||{})){const r=d.trim(),n=c[d];a[r]=typeof n=="string"?n.trim():n}return a}function y(c){const a=f(c),d=Object.entries(a).map(([p,g])=>[l(p),p,g]),r=p=>{const g=d.find(([m])=>p.every(j=>m.includes(j)));return g?g[1]:null},n=r(["id"])||r(["شناسه"]),i=r(["description","id"])||r(["شرح","کالا"])||r(["شرح"]),h=r(["vat"])||r(["مالیات","ارزش"])||r(["درصد"]),u=r(["type"])||r(["گروه"])||r(["نوع"]),x=r(["special","general"])||r(["عمومی"])||r(["خاص"]),e=r(["run","date"])||r(["تاریخ","اجرا"]),s=r(["last","edit","date"])||r(["آخرین","ویرایش"]);return{id:n?a[n]:"",title:i?a[i]:"",vat:h?a[h]:"",group:u?a[u]:"",scope:x?a[x]:"",runDate:e?a[e]:"",lastEditDate:s?a[s]:"",__raw:a}}const k=()=>{const[c,a]=o.useState(""),[d,r]=o.useState([]),[n,i]=o.useState("");o.useEffect(()=>{fetch("/search_product_id.json").then(e=>{if(!e.ok)throw new Error("خطا در دریافت search_product_id.json");return e.json()}).then(e=>{let s=[];Array.isArray(e)?s=e:Array.isArray(e?.data)?s=e.data:typeof e=="object"&&(s=Object.values(e)),r(s),i("")}).catch(e=>{console.error(e),i("خطا در بارگذاری داده ها. مسیر /search_product_id.json را بررسی کنید.")})},[]);const h=o.useMemo(()=>d.map(y),[d]),u=o.useMemo(()=>{const e=l(c);return e.length<=1?[]:h.filter(s=>[l(s.id),l(s.title),l(s.vat),l(s.group),l(s.scope),l(s.runDate),l(s.lastEditDate)].join(" ").includes(e)).slice(0,20)},[h,c]),x=e=>a(e.target.value);return t.jsxs("div",{className:"w-full max-w-4xl mx-auto",children:[t.jsxs("div",{className:"relative mb-3",children:[t.jsx("input",{type:"text",placeholder:"جستجو در «شناسه»، «شرح کالا»، «گروه/نوع»، «عمومی/خاص»، «VAT» یا تاریخ ها…",value:c,onChange:x,className:"w-full border rounded-lg p-3 shadow-sm focus:outline-none focus:ring-2 focus:ring-[#B50000] dark:bg-[#0f172a] dark:text-gray-100 dark:border-gray-700",dir:"rtl"}),n&&t.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:n})]}),c.trim().length>1&&t.jsx(t.Fragment,{children:u.length>0?t.jsxs("table",{className:"w-full mt-2 border border-gray-300 rounded-lg text-sm overflow-hidden dark:border-gray-700",children:[t.jsx("thead",{className:"bg-gray-200 dark:bg-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-2 text-right",children:"شناسه"}),t.jsx("th",{className:"p-2 text-right",children:"شرح کالا"}),t.jsx("th",{className:"p-2 text-right",children:"گروه/نوع"}),t.jsx("th",{className:"p-2 text-right",children:"عمومی/خاص"}),t.jsx("th",{className:"p-2 text-right",children:"VAT"}),t.jsx("th",{className:"p-2 text-right",children:"تاریخ اجرا"}),t.jsx("th",{className:"p-2 text-right",children:"آخرین ویرایش"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-slate-900",children:u.map((e,s)=>t.jsxs("tr",{className:"border-t hover:bg-gray-50 dark:hover:bg-slate-800 dark:border-gray-700",children:[t.jsx("td",{className:"p-2 ltr",children:e.id||"—"}),t.jsx("td",{className:"p-2",children:e.title||"—"}),t.jsx("td",{className:"p-2",children:e.group||"—"}),t.jsx("td",{className:"p-2",children:e.scope||"—"}),t.jsx("td",{className:"p-2",children:e.vat?`${e.vat}%`:"—"}),t.jsx("td",{className:"p-2",children:e.runDate||"—"}),t.jsx("td",{className:"p-2",children:e.lastEditDate||"—"})]},s))})]}):t.jsx("p",{className:"mt-4 text-sm text-gray-600 dark:text-gray-300",children:"هیچ موردی یافت نشد."})})]})};export{k as default};
